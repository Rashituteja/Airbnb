<% layout('layouts/boilerplate') %>
<body>
    <div class="row">
        <div class="col-8 offset-2">

        </div>
    </div>
   <div class="card col-8 offset-2"  >
  <img src="<%=listing.image.url%>" class="card-img-top show-img"  style="width: 30rem;">
  <div class="card-body">
    <p class="card-text">
         <%= listing.title%>
         <br>
         <p><%= listing.description%></p>
         <br>
         &#8377;<%= listing.price%>
         <br>
         <%= listing.location%>
         <br>
        <%= listing.country%>
    </p>
   <div class="btns">
  
         <a href="/listings/<%=listing._id%>/edit" class="btn btn-dark ">edit</a>
<br>
<form method="POST"action="/listings/<%=listing._id%>?_method=DELETE">
    <button class="btn btn-sm btn-danger ">Delete </button>
</form>

   </div>
   <div class="col offset-2">
  <hr/>
  <h3>Leave a Review</h3>
  <form action="/listings/<%= listing._id %>/reviews" method="POST">
    <div class="mb-3 mt-3">
      <label for="rating" class="form-label">Rating</label>
      <input type="range" min="1" max="5" id="rating" name="review[rating]" class="form-control">
    </div>
    <div class="mb-3 mt-3">
      <label for="comment" class="form-label">Comments</label>
      <textarea name="review[comment]" id="comment" cols="30" rows="5" class="form-control"></textarea>
    </div>
    <button class="btn btn-dark">Submit</button>
  </form>

  <hr/>
  <h4>All reviews</h4>
  <div class="row g-3">
  <% if (listing.reviews && listing.reviews.length > 0) { %>
    <% for (let review of listing.reviews) { %>
      <div class="card-review  col-md-6">
        <div class="card-body">
          <h4 class="card-title">john joe</h4>
        <h5><%= review.comment %></h4>
      <p><%= review.rating %> star</p>
        <form method="POST" action="/listings/<%= listing._id %>/reviews/<%= review._id %>?_method=DELETE" class="mt-2">
      <button type="submit" class="btn btn-sm btn-danger">Delete</button>
    </form>
        </div>
      </div>
   
    <% } %>
  <% } else { %>
    <p>No reviews yet.</p>
  <% } %>
</div>
 </div>
</div>
  </div>
</div>


 </div>
    </div>
</body>

